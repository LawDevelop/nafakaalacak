<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nafaka GeÃ§miÅŸ Faiz Hesaplama</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ›ï¸ Nafaka GeÃ§miÅŸ Faiz Hesaplama Sistemi</h1>
            <p class="subtitle">GeÃ§miÅŸ nafaka alacaklarÄ±nÄ±zÄ±n faiz hesaplamasÄ±nÄ± yapÄ±n</p>
        </header>

        <div class="main-content">
            <!-- AdÄ±m 1: Otomatik DÃ¶nem OluÅŸturma -->
            <section class="card" id="step1">
                <div class="card-header">
                    <h2>ğŸ“… AdÄ±m 1: Nafaka DÃ¶nemlerini OluÅŸtur</h2>
                </div>
                <div class="card-body">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="startDate">BaÅŸlangÄ±Ã§ Tarihi</label>
                            <input type="date" id="startDate" required>
                        </div>
                        <div class="form-group">
                            <label for="endDate">BitiÅŸ Tarihi</label>
                            <input type="date" id="endDate" required>
                        </div>
                        <div class="form-group">
                            <label for="monthlyAmount">AylÄ±k Nafaka TutarÄ± (â‚º)</label>
                            <input type="number" id="monthlyAmount" step="0.01" min="0" placeholder="Ã–rn: 5000" required>
                        </div>
                        <div class="form-group">
                            <label for="dueDay">Muacceliyet GÃ¼nÃ¼</label>
                            <input type="number" id="dueDay" min="1" max="31" placeholder="Ã–rn: 5" required>
                            <small>NafakanÄ±n her ay hangi gÃ¼nÃ¼nde muaccel olduÄŸu</small>
                        </div>
                        <div class="form-group">
                            <label for="annualIncreaseRate">YÄ±llÄ±k ArtÄ±ÅŸ OranÄ± (%) - Opsiyonel</label>
                            <input type="number" id="annualIncreaseRate" step="0.01" min="0" placeholder="Ã–rn: 10">
                            <small>Nafaka tutarÄ±nda yÄ±llÄ±k artÄ±ÅŸ varsa</small>
                        </div>
                        <div class="form-group">
                            <label for="increaseMonth">ArtÄ±ÅŸ AyÄ± - Opsiyonel</label>
                            <select id="increaseMonth">
                                <option value="1">Ocak</option>
                                <option value="2">Åubat</option>
                                <option value="3">Mart</option>
                                <option value="4">Nisan</option>
                                <option value="5">MayÄ±s</option>
                                <option value="6">Haziran</option>
                                <option value="7">Temmuz</option>
                                <option value="8">AÄŸustos</option>
                                <option value="9">EylÃ¼l</option>
                                <option value="10">Ekim</option>
                                <option value="11">KasÄ±m</option>
                                <option value="12">AralÄ±k</option>
                            </select>
                            <small>ArtÄ±ÅŸÄ±n uygulanacaÄŸÄ± ay</small>
                        </div>
                    </div>
                    <button class="btn btn-primary" onclick="generatePeriods()">
                        âœ¨ DÃ¶nemleri OluÅŸtur
                    </button>
                </div>
            </section>

            <!-- AdÄ±m 2: DÃ¶nem DÃ¼zenleme -->
            <section class="card" id="step2" style="display: none;">
                <div class="card-header">
                    <h2>âœï¸ AdÄ±m 2: DÃ¶nemleri DÃ¼zenle</h2>
                </div>
                <div class="card-body">
                    <div class="toolbar">
                        <button class="btn btn-secondary" onclick="addPeriodManual()">
                            â• Manuel DÃ¶nem Ekle
                        </button>
                        <span class="period-count" id="periodCount"></span>
                    </div>
                    
                    <div class="table-container">
                        <table id="periodsTable">
                            <thead>
                                <tr>
                                    <th>SÄ±ra</th>
                                    <th>Muacceliyet Tarihi</th>
                                    <th>Tutar (â‚º)</th>
                                    <th>Faiz OranÄ± (%)</th>
                                    <th>AÃ§Ä±klama</th>
                                    <th>Ä°ÅŸlemler</th>
                                </tr>
                            </thead>
                            <tbody id="periodsTableBody">
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- AdÄ±m 3: Faiz Hesaplama -->
            <section class="card" id="step3" style="display: none;">
                <div class="card-header">
                    <h2>ğŸ§® AdÄ±m 3: Faiz Hesapla</h2>
                </div>
                <div class="card-body">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="calculationEndDate">Hesaplama BitiÅŸ Tarihi</label>
                            <input type="date" id="calculationEndDate" required>
                            <small>Faiz hangi tarihe kadar hesaplanacak</small>
                        </div>
                        <div class="form-group">
                            <label for="interestRate">VarsayÄ±lan Faiz OranÄ± (%)</label>
                            <input type="number" id="interestRate" step="0.01" min="0" value="24" placeholder="Ã–rn: 24" required>
                            <small>TÃ¼m dÃ¶nemler iÃ§in varsayÄ±lan oran</small>
                        </div>
                        <div class="form-group">
                            <label>Faize Esas GÃ¼n</label>
                            <div class="radio-group">
                                <label class="radio-label">
                                    <input type="radio" name="dayBasis" value="360" checked>
                                    <span>360 GÃ¼n</span>
                                </label>
                                <label class="radio-label">
                                    <input type="radio" name="dayBasis" value="365">
                                    <span>365 GÃ¼n</span>
                                </label>
                            </div>
                        </div>
                    </div>
                    <div class="info-box">
                        <strong>ğŸ’¡ Ä°pucu:</strong> VarsayÄ±lan faiz oranÄ± tÃ¼m dÃ¶nemler iÃ§in kullanÄ±lÄ±r. Belirli dÃ¶nemler iÃ§in farklÄ± faiz oranÄ± uygulamak istiyorsanÄ±z, AdÄ±m 2'deki tabloda "Faiz OranÄ±" sÃ¼tununa tÄ±klayarak dÃ¶nem bazlÄ± faiz oranÄ± belirleyebilirsiniz.
                    </div>
                    <button class="btn btn-success" onclick="calculateInterest()">
                        ğŸ’° Faiz Hesapla
                    </button>
                </div>
            </section>

            <!-- Takvim DoÄŸrulama -->
            <section class="card" id="calendarValidation">
                <div class="card-header">
                    <h2>ğŸ“… Takvim DoÄŸrulama Sistemi</h2>
                </div>
                <div class="card-body">
                    <p>Sistemin tarih hesaplamalarÄ±nÄ±n doÄŸruluÄŸunu kontrol edin. ArtÄ±k yÄ±llar, ay gÃ¼n sayÄ±larÄ± ve takvim tutarlÄ±lÄ±ÄŸÄ± test edilir.</p>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="validationStartYear">BaÅŸlangÄ±Ã§ YÄ±lÄ±</label>
                            <input type="number" id="validationStartYear" value="2000" min="1900" max="2100">
                        </div>
                        <div class="form-group">
                            <label for="validationEndYear">BitiÅŸ YÄ±lÄ±</label>
                            <input type="number" id="validationEndYear" value="2030" min="1900" max="2100">
                        </div>
                    </div>
                    <button class="btn btn-primary" onclick="validateCalendar()">
                        ğŸ” Takvimi DoÄŸrula
                    </button>
                    <div id="validationResults" style="display: none; margin-top: 1.5rem;"></div>
                </div>
            </section>

            <!-- SonuÃ§lar -->
            <section class="card" id="results" style="display: none;">
                <div class="card-header">
                    <h2>ğŸ“Š Hesaplama SonuÃ§larÄ±</h2>
                    <div style="display: flex; gap: 0.5rem;">
                        <button class="btn btn-secondary btn-sm" onclick="exportToExcel()">ğŸ“Š Excel Ä°ndir</button>
                        <button class="btn btn-secondary btn-sm" onclick="exportToCSV()">ğŸ“„ CSV Ä°ndir</button>
                        <button class="btn btn-secondary btn-sm" onclick="printResults()">ğŸ–¨ï¸ YazdÄ±r</button>
                    </div>
                </div>
                <div class="card-body">
                    <!-- Ã–zet KartlarÄ± -->
                    <div class="summary-cards">
                        <div class="summary-card">
                            <div class="summary-label">Toplam Anapara</div>
                            <div class="summary-value" id="totalPrincipal">0,00 â‚º</div>
                        </div>
                        <div class="summary-card">
                            <div class="summary-label">Toplam Faiz</div>
                            <div class="summary-value highlight" id="totalInterest">0,00 â‚º</div>
                        </div>
                        <div class="summary-card">
                            <div class="summary-label">Genel Toplam</div>
                            <div class="summary-value grand-total" id="grandTotal">0,00 â‚º</div>
                        </div>
                    </div>

                    <!-- Hesaplama Bilgileri -->
                    <div class="calculation-info" id="calculationInfo"></div>

                    <!-- DetaylÄ± SonuÃ§lar Tablosu -->
                    <div class="table-container">
                        <table id="resultsTable">
                            <thead>
                                <tr>
                                    <th>SÄ±ra</th>
                                    <th>Muacceliyet Tarihi</th>
                                    <th>AÃ§Ä±klama</th>
                                    <th>Anapara (â‚º)</th>
                                    <th>GÃ¼n SayÄ±sÄ±</th>
                                    <th>Faiz OranÄ± (%)</th>
                                    <th>Faiz (â‚º)</th>
                                    <th>Toplam (â‚º)</th>
                                </tr>
                            </thead>
                            <tbody id="resultsTableBody">
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>
        </div>
    </div>

    <!-- Modal for Manual Period Add -->
    <div id="manualPeriodModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Manuel DÃ¶nem Ekle</h3>
                <span class="close" onclick="closeManualModal()">&times;</span>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="manualDueDate">Muacceliyet Tarihi</label>
                    <input type="date" id="manualDueDate" required>
                </div>
                <div class="form-group">
                    <label for="manualAmount">Tutar (â‚º)</label>
                    <input type="number" id="manualAmount" step="0.01" min="0" required>
                </div>
                <div class="form-group">
                    <label for="manualDescription">AÃ§Ä±klama</label>
                    <input type="text" id="manualDescription" placeholder="Ã–rn: Ocak 2024 NafakasÄ±">
                </div>
                <div class="form-group">
                    <label for="manualInterestRate">Ã–zel Faiz OranÄ± (%) - Opsiyonel</label>
                    <input type="number" id="manualInterestRate" step="0.01" min="0" placeholder="BoÅŸ bÄ±rakÄ±lÄ±rsa varsayÄ±lan oran kullanÄ±lÄ±r">
                    <small>Bu dÃ¶neme Ã¶zel faiz oranÄ± belirlemek iÃ§in</small>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeManualModal()">Ä°ptal</button>
                <button class="btn btn-primary" onclick="saveManualPeriod()">Kaydet</button>
            </div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>
